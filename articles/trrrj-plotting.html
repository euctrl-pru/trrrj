<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Plotting trajectories • trrrj</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Plotting trajectories">
<meta property="og:description" content="trrrj">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">trrrj</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/trrrj-plotting.html">Plotting trajectories</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/euctrl-pru/trrrj/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Plotting trajectories</h1>
                        <h4 data-toc-skip class="author">Enrico
Spinielli</h4>
            
            <h4 data-toc-skip class="date">2024-02-12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/euctrl-pru/trrrj/blob/HEAD/vignettes/trrrj-plotting.Rmd" class="external-link"><code>vignettes/trrrj-plotting.Rmd</code></a></small>
      <div class="hidden name"><code>trrrj-plotting.Rmd</code></div>

    </div>

    
    
<p>It is sometimes usefult to visually inspect flight trajectories. This
vignette provides some examples and code snippets that show how to plot
trajectories from Flight Radar 24 feed. In fact the snippets here can be
used with any dataframe of position reports containing at least
<code>timestamp</code>, <code>longitude</code>, <code>latitude</code>
and <code>altitude</code> fields.</p>
<div class="section level2">
<h2 id="plotting">Plotting<a class="anchor" aria-label="anchor" href="#plotting"></a>
</h2>
<p>In order to get some sample trajectory data, you can use the
<code>trrrj</code> package datasets:</p>
<ul>
<li>
<code>flts</code>: 41 flights from FR24 for 2017-02-05 and
2017-02-05, check the documentation via <code><a href="../reference/flts.html">?flts</a></code>
</li>
<li>
<code>poss</code>: ADS-B positions reports for <code>flts</code>,
check the documentation via <code><a href="../reference/poss.html">?poss</a></code>
</li>
<li>
<code>cprs</code>: CPR’s matching <code>flts</code>, check the
documentation via <code><a href="../reference/cprs.html">?cprs</a></code>
</li>
</ul>
<p>We now plot the ADS-B positions just for one flight, flight
<code>RYR19QK</code> from Comiso to Malpensa:</p>
<table style="width:100%;" class="table">
<colgroup>
<col width="12%">
<col width="7%">
<col width="9%">
<col width="6%">
<col width="11%">
<col width="7%">
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="left">date</th>
<th align="left">flight</th>
<th align="left">callsign</th>
<th align="left">equip</th>
<th align="right">fr24_id</th>
<th align="right">nm_id</th>
<th align="left">adep_icao</th>
<th align="left">adep_iata</th>
<th align="left">ades_icao</th>
<th align="left">ades_iata</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">2017-02-06</td>
<td align="left">FR8730</td>
<td align="left">RYR19QK</td>
<td align="left">B738</td>
<td align="right">207752905</td>
<td align="right">884714</td>
<td align="left">LIMC</td>
<td align="left">MXP</td>
<td align="left">LICB</td>
<td align="left">CIY</td>
</tr></tbody>
</table>
<p>We can now plot the ADS-B trajectory:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">europe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>left <span class="op">=</span> <span class="fl">5</span>, bottom <span class="op">=</span> <span class="fl">35</span>, right <span class="op">=</span> <span class="fl">30</span>, top <span class="op">=</span> <span class="fl">52</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># let's just focus on 1 flight</span></span>
<span><span class="va">trj_adsb</span> <span class="op">&lt;-</span> <span class="va">poss</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">flight_id</span> <span class="op">==</span> <span class="fl">207752905</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">trrrj</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_flight_horizontal.html">plot_flight_horizontal</a></span><span class="op">(</span><span class="va">trj_adsb</span>, bbox <span class="op">=</span> <span class="va">europe</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="trrrj-plotting_files/figure-html/trj-adsb-ggmap-1.png" alt="2D plot via ggmap" width="672"><p class="caption">
2D plot via ggmap
</p>
</div>
<p>and the one from the CPRs:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trj_cpr</span> <span class="op">&lt;-</span> <span class="va">cprs</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">callsign</span> <span class="op">==</span> <span class="st">"RYR19QK"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">trj_cpr</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">trrrj</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_cpr_horizontal.html">plot_cpr_horizontal</a></span><span class="op">(</span><span class="va">europe</span>, linewidth <span class="op">=</span> <span class="fl">1.3</span>, colour <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="trrrj-plotting_files/figure-html/trj-cpr-ggmap-1.png" alt="2D plot via ggmap" width="672"><p class="caption">
2D plot via ggmap
</p>
</div>
<p>We can also see the vertical profiles vs distance (for the ADS-B
trajectory):</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_flight_vertical_distance.html">plot_flight_vertical_distance</a></span><span class="op">(</span><span class="va">trj_adsb</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/cumulative_distance.html">cumulative_distance</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="trrrj-plotting_files/figure-html/vert-distance-1.png" alt="Flight's vertical profile vs. distance" width="672"><p class="caption">
Flight’s vertical profile vs. distance
</p>
</div>
<p>or time:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_flight_vertical_time.html">plot_flight_vertical_time</a></span><span class="op">(</span><span class="va">trj_adsb</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/cumulative_time.html">cumulative_time</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="trrrj-plotting_files/figure-html/vert-time-1.png" alt="Flight's vertical profile vs. time" width="672"><p class="caption">
Flight’s vertical profile vs. time
</p>
</div>
<p>Now let’s plot all CPR trajectories (with automatic bounding
box):</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cprs</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/plot_cpr_horizontal.html">plot_cpr_horizontal</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1.3</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="trrrj-plotting_files/figure-html/all-cprs-2d-1.png" alt="A map of all sample CPR trajectories" width="672"><p class="caption">
A map of all sample CPR trajectories
</p>
</div>
<div class="section level3">
<h3 id="base-map-europe">Base map: Europe<a class="anchor" aria-label="anchor" href="#base-map-europe"></a>
</h3>
<p>The <code>pruatlas</code> package provides a base map for Europe
using a Lambert Azimuthal Equal-Area projection. It could be a useful
package to further extend for plotting trajectories. It is on PRU’s
github account, <a href="https://github.com/euctrl-pru/pruatlas" class="external-link">euctrl-pru/pruatlas</a>.</p>
</div>
<div class="section level3">
<h3 id="retrive-fr24-ads-b-data-from-db">Retrive FR24 ADS-B data from DB<a class="anchor" aria-label="anchor" href="#retrive-fr24-ads-b-data-from-db"></a>
</h3>
<p>The <code>trrrj</code> package provides an API to retrieve FR24 data
from the DB. The use case here is for flights around an airport.</p>
<p>Before continuing <strong>BE CAREFUL</strong> about how to use it,
you could get a lot of data back and il could take a lot of time.</p>
<p>Let’s say you want to retrieve the <em>arrival</em> flow to <a href="https://en.wikipedia.org/wiki/Stavanger_Airport,_Sola" class="external-link">Stavanger
airport</a> in Norway for the 6th Sep 2017, then you need to issue the
following command (showing the first 10 ones only):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">svg20170906flt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/export_flights_at_airport_fr24.html">export_flights_at_airport_fr24</a></span><span class="op">(</span><span class="st">"2017-09-06T00:00:00Z"</span>,</span>
<span>                                                 <span class="st">"2017-09-07T00:00:00Z"</span>,</span>
<span>                                                 <span class="st">"SVG"</span>,</span>
<span>                                                 flow <span class="op">=</span> <span class="st">"ARR"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># fake the ROracle call</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span>file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"/data/flts.rda"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">svg20170906flt</span> <span class="op">&lt;-</span>  <span class="va">flts</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">real_to</span> <span class="op">==</span> <span class="st">"BRU"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">svg20170906flt</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  caption <span class="op">=</span> <span class="st">"Arrival flights at Stavanger airport, Norway, on Sep 6, 2017 (10 only)"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Arrival flights at Stavanger airport, Norway, on Sep 6, 2017
(10 only)</caption>
<colgroup>
<col width="11%">
<col width="13%">
<col width="6%">
<col width="6%">
<col width="10%">
<col width="8%">
<col width="11%">
<col width="9%">
<col width="9%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="right">flight_id</th>
<th align="left">aircraft_id</th>
<th align="left">reg</th>
<th align="left">equip</th>
<th align="left">callsign</th>
<th align="left">flight</th>
<th align="left">schd_from</th>
<th align="left">schd_to</th>
<th align="left">real_to</th>
<th align="left">date</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">207635488</td>
<td align="left">4509122</td>
<td align="left">OOSNB</td>
<td align="left">A320</td>
<td align="left">BEL3292</td>
<td align="left">SN3292</td>
<td align="left">TLV</td>
<td align="left">BRU</td>
<td align="left">BRU</td>
<td align="left">2017-02-05</td>
</tr></tbody>
</table>
<p>To get the position reports 40 NM around the airport for those
flights (showing the first 10 ones):</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/euctrl-pru/trrrj" class="external-link">trrrj</a></span><span class="op">)</span></span>
<span><span class="co"># TODO: handle the case when building w/ Oracle DB</span></span>
<span><span class="va">svg20170906pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/export_flights_at_airport_fr24.html">export_flights_at_airport_fr24</a></span><span class="op">(</span></span>
<span>  <span class="st">"2017-09-06"</span>, <span class="st">"2017-09-07"</span>,</span>
<span>  <span class="st">"SVG"</span>, <span class="fl">5.638</span>, <span class="fl">58.877</span>,</span>
<span>  flow <span class="op">=</span> <span class="st">"ARR"</span>,</span>
<span>  radius <span class="op">=</span> <span class="fl">40</span><span class="op">)</span></span>
<span><span class="co"># knitr::kable(head(svg20170906pos, 10))</span></span></code></pre></div>
<p>Then prepare the data and then plot:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">svg20170906pos</span> <span class="op">&lt;-</span> <span class="va">svg20170906pos</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>longitude <span class="op">=</span> <span class="va">LON</span>, latitude <span class="op">=</span> <span class="va">LAT</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>longitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">longitude</span><span class="op">)</span>, latitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">latitude</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">svg20170906flt</span> <span class="op">&lt;-</span> <span class="va">svg20170906flt</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>callsign <span class="op">=</span> <span class="va">CALLSIGN</span><span class="op">)</span></span>
<span></span>
<span><span class="va">svg20170906pos</span> <span class="op">&lt;-</span> <span class="va">svg20170906pos</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">svg20170906flt</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_flight_horizontal.html">plot_flight_horizontal</a></span><span class="op">(</span><span class="va">svg20170906pos</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="file-archived-trajectories">(File) Archived Trajectories<a class="anchor" aria-label="anchor" href="#file-archived-trajectories"></a>
</h2>
<p>FR24 archive files can be accessed with standard R tools like
<code>readr</code> to retrieve the flight list for some of the companion
sample files in this package:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/euctrl-pru/trrrj" class="external-link">trrrj</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">######## flights</span></span>
<span><span class="va">flights_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"trrrj"</span><span class="op">)</span></span>
<span><span class="va">flights_csvs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="va">flights_dir</span>, pattern <span class="op">=</span> <span class="st">"201702.._flights\\.csv"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">flights</span> <span class="op">&lt;-</span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_df</a></span><span class="op">(</span><span class="va">flights_csvs</span>, <span class="va">read_csv</span><span class="op">)</span></span></code></pre></div>
<p>Here are the first 10 entries (some variables omitted):</p>
<table class="table">
<thead><tr class="header">
<th align="right">flight_id</th>
<th align="left">reg</th>
<th align="left">equip</th>
<th align="left">schd_from</th>
<th align="left">schd_to</th>
<th align="left">real_to</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">207610917</td>
<td align="left">OKYBA</td>
<td align="left">A333</td>
<td align="left">PRG</td>
<td align="left">ICN</td>
<td align="left">ICN</td>
</tr>
<tr class="even">
<td align="right">207541132</td>
<td align="left">EIEBP</td>
<td align="left">B738</td>
<td align="left">CHQ</td>
<td align="left">SKG</td>
<td align="left">SKG</td>
</tr>
<tr class="odd">
<td align="right">207587763</td>
<td align="left">GCIXW</td>
<td align="left">E170</td>
<td align="left">HAM</td>
<td align="left">LCY</td>
<td align="left">LCY</td>
</tr>
<tr class="even">
<td align="right">207507520</td>
<td align="left">VTANP</td>
<td align="left">B788</td>
<td align="left">AMD</td>
<td align="left">LHR</td>
<td align="left">LHR</td>
</tr>
</tbody>
</table>
<p>A sample of FR24 flight data is available as <code>flts</code>
dataset in the package. See also the relevant help page,
<code><a href="../reference/flts.html">?flts</a></code>.</p>
<div class="section level3">
<h3 id="file-archived-positions">(File) Archived Positions<a class="anchor" aria-label="anchor" href="#file-archived-positions"></a>
</h3>
<div class="section level4">
<h4 id="ads-b-positions">ADS-B Positions<a class="anchor" aria-label="anchor" href="#ads-b-positions"></a>
</h4>
<p>The <code>trrrj</code> package provides helpes to read position
report files from FR24 archive data feed. In order to read the ADS-B
position reports for the days from the previous section:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">######## positions</span></span>
<span><span class="va">poss_dirs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"20170206_positions"</span>, <span class="st">"20170205_positions"</span><span class="op">)</span></span>
<span><span class="va">poss_dirs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="va">poss_dirs</span>, package <span class="op">=</span> <span class="st">"trrrj"</span><span class="op">)</span></span>
<span><span class="va">poss_csvs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="va">poss_dirs</span>, pattern <span class="op">=</span> <span class="st">"201702.._.*\\.csv"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">positions</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_dfr</a></span><span class="op">(</span><span class="va">poss_csvs</span>, <span class="va">read_positions_fr24</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># augment with flight info</span></span>
<span><span class="va">positions</span> <span class="op">&lt;-</span> <span class="va">positions</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">flights</span>, by <span class="op">=</span> <span class="st">"flight_id"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">callsign</span><span class="op">)</span>, <span class="va">callsign</span> <span class="op">!=</span> <span class="st">"YELLOW6"</span><span class="op">)</span></span></code></pre></div>
<p>The first 10 entries (some variables omitted) for flight “AIC175”
(<code>flight_id</code> = <code>207507520</code>) are:</p>
<table class="table">
<colgroup>
<col width="13%">
<col width="27%">
<col width="12%">
<col width="11%">
<col width="12%">
<col width="13%">
<col width="8%">
</colgroup>
<thead><tr class="header">
<th align="right">flight_id</th>
<th align="left">timestamp</th>
<th align="right">altitude</th>
<th align="right">heading</th>
<th align="right">latitude</th>
<th align="right">longitude</th>
<th align="right">speed</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">207507520</td>
<td align="left">2017-02-05 04:56:15</td>
<td align="right">38000</td>
<td align="right">291</td>
<td align="right">36.18664</td>
<td align="right">52.95428</td>
<td align="right">425</td>
</tr>
<tr class="even">
<td align="right">207507520</td>
<td align="left">2017-02-05 04:57:17</td>
<td align="right">38000</td>
<td align="right">291</td>
<td align="right">36.23184</td>
<td align="right">52.81566</td>
<td align="right">424</td>
</tr>
<tr class="odd">
<td align="right">207507520</td>
<td align="left">2017-02-05 04:58:18</td>
<td align="right">38000</td>
<td align="right">291</td>
<td align="right">36.27630</td>
<td align="right">52.67845</td>
<td align="right">424</td>
</tr>
<tr class="even">
<td align="right">207507520</td>
<td align="left">2017-02-05 04:59:20</td>
<td align="right">38000</td>
<td align="right">291</td>
<td align="right">36.32181</td>
<td align="right">52.53754</td>
<td align="right">424</td>
</tr>
<tr class="odd">
<td align="right">207507520</td>
<td align="left">2017-02-05 05:00:21</td>
<td align="right">37975</td>
<td align="right">291</td>
<td align="right">36.36580</td>
<td align="right">52.40049</td>
<td align="right">422</td>
</tr>
<tr class="even">
<td align="right">207507520</td>
<td align="left">2017-02-05 05:01:22</td>
<td align="right">38000</td>
<td align="right">291</td>
<td align="right">36.40934</td>
<td align="right">52.26424</td>
<td align="right">423</td>
</tr>
<tr class="odd">
<td align="right">207507520</td>
<td align="left">2017-02-05 05:02:26</td>
<td align="right">38000</td>
<td align="right">291</td>
<td align="right">36.45547</td>
<td align="right">52.11931</td>
<td align="right">423</td>
</tr>
<tr class="even">
<td align="right">207507520</td>
<td align="left">2017-02-05 05:03:28</td>
<td align="right">38000</td>
<td align="right">291</td>
<td align="right">36.49900</td>
<td align="right">51.98169</td>
<td align="right">424</td>
</tr>
<tr class="odd">
<td align="right">207507520</td>
<td align="left">2017-02-05 05:04:30</td>
<td align="right">38000</td>
<td align="right">291</td>
<td align="right">36.54406</td>
<td align="right">51.83893</td>
<td align="right">423</td>
</tr>
<tr class="even">
<td align="right">207507520</td>
<td align="left">2017-02-05 05:05:33</td>
<td align="right">38000</td>
<td align="right">291</td>
<td align="right">36.58923</td>
<td align="right">51.69468</td>
<td align="right">425</td>
</tr>
</tbody>
</table>
<p>A sample of FR24 ADS-B position report data is available as
<code>poss</code> dataset in the package. See also the relevant help
page, <code><a href="../reference/poss.html">?poss</a></code>.</p>
</div>
<div class="section level4">
<h4 id="file-archived-correlated-position-reports-cprs">(File) Archived Correlated Position Reports (CPR’s)<a class="anchor" aria-label="anchor" href="#file-archived-correlated-position-reports-cprs"></a>
</h4>
<p>The <code>trrrj</code> package provides facilities to read NM’s
archived CPR files. In order to import all cprs for the 2 demo days:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># read all 5th and 6th February 2017 CPR's files</span></span>
<span><span class="co"># cprs_dirs &lt;- system.file("extdata", package = "trrrj")</span></span>
<span><span class="co"># cprs_delims &lt;- dir(</span></span>
<span><span class="co">#    cprs_dirs,</span></span>
<span><span class="co">#    pattern = "1.2017020.1001tacop304ARCHIVED_OPLOG_ALL_CPR\\.gz",</span></span>
<span><span class="co">#    full.names = TRUE)</span></span>
<span><span class="va">cprs_delims</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/trrrj_example.html">trrrj_example</a></span><span class="op">(</span><span class="st">"1.201702051001tacop304ARCHIVED_OPLOG_ALL_CPR.gz"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/trrrj_example.html">trrrj_example</a></span><span class="op">(</span><span class="st">"1.201702061001tacop304ARCHIVED_OPLOG_ALL_CPR.gz"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">poss_cpr</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_dfr</a></span><span class="op">(</span><span class="va">cprs_delims</span>, <span class="va">read_cpr</span><span class="op">)</span></span></code></pre></div>
<p>and then show the first 10 entries (some variables omitted) for the
same flight, “AIC175”, as for the ADS-B positions:</p>
<table class="table">
<colgroup>
<col width="8%">
<col width="21%">
<col width="9%">
<col width="13%">
<col width="14%">
<col width="9%">
<col width="10%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="right">tact_id</th>
<th align="left">timestamp_track</th>
<th align="left">callsign</th>
<th align="right">flight_level</th>
<th align="right">track_heading</th>
<th align="right">latitude</th>
<th align="right">longitude</th>
<th align="right">track_speed</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">847918</td>
<td align="left">2017-02-05 07:25:16</td>
<td align="left">AIC175</td>
<td align="right">400</td>
<td align="right">304.7772</td>
<td align="right">42.63778</td>
<td align="right">30.22139</td>
<td align="right">461</td>
</tr>
<tr class="even">
<td align="right">847918</td>
<td align="left">2017-02-05 07:25:25</td>
<td align="left">AIC175</td>
<td align="right">400</td>
<td align="right">311.4294</td>
<td align="right">42.65250</td>
<td align="right">30.20500</td>
<td align="right">480</td>
</tr>
<tr class="odd">
<td align="right">847918</td>
<td align="left">2017-02-05 07:25:50</td>
<td align="left">AIC175</td>
<td align="right">400</td>
<td align="right">312.6158</td>
<td align="right">42.68667</td>
<td align="right">30.14944</td>
<td align="right">462</td>
</tr>
<tr class="even">
<td align="right">847918</td>
<td align="left">2017-02-05 07:25:54</td>
<td align="left">AIC175</td>
<td align="right">400</td>
<td align="right">309.5233</td>
<td align="right">42.69167</td>
<td align="right">30.14389</td>
<td align="right">457</td>
</tr>
<tr class="odd">
<td align="right">847918</td>
<td align="left">2017-02-05 07:26:19</td>
<td align="left">AIC175</td>
<td align="right">400</td>
<td align="right">311.1658</td>
<td align="right">42.72667</td>
<td align="right">30.08583</td>
<td align="right">462</td>
</tr>
<tr class="even">
<td align="right">847918</td>
<td align="left">2017-02-05 07:26:28</td>
<td align="left">AIC175</td>
<td align="right">400</td>
<td align="right">307.4578</td>
<td align="right">42.73833</td>
<td align="right">30.06889</td>
<td align="right">463</td>
</tr>
<tr class="odd">
<td align="right">847918</td>
<td align="left">2017-02-05 07:26:48</td>
<td align="left">AIC175</td>
<td align="right">400</td>
<td align="right">311.4350</td>
<td align="right">42.76778</td>
<td align="right">30.02306</td>
<td align="right">464</td>
</tr>
<tr class="even">
<td align="right">847918</td>
<td align="left">2017-02-05 07:26:57</td>
<td align="left">AIC175</td>
<td align="right">400</td>
<td align="right">308.3697</td>
<td align="right">42.78000</td>
<td align="right">30.00639</td>
<td align="right">464</td>
</tr>
<tr class="odd">
<td align="right">847918</td>
<td align="left">2017-02-05 07:27:21</td>
<td align="left">AIC175</td>
<td align="right">400</td>
<td align="right">311.6161</td>
<td align="right">42.81611</td>
<td align="right">29.94917</td>
<td align="right">466</td>
</tr>
<tr class="even">
<td align="right">847918</td>
<td align="left">2017-02-05 07:27:30</td>
<td align="left">AIC175</td>
<td align="right">400</td>
<td align="right">308.6775</td>
<td align="right">42.82833</td>
<td align="right">29.93306</td>
<td align="right">465</td>
</tr>
</tbody>
</table>
<p>A sample of NM’s CPR’s data is available as <code>cprs</code> dataset
in the package. See also the relevant help page, <code><a href="../reference/cprs.html">?cprs</a></code>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://enrico.spinielli.net" class="external-link">Enrico Spinielli</a>, <a href="https://www.eurocontrol.int" class="external-link"><img src="https://ansperformance.eu/nvctr/reference/figures/euctrl-logo-wide.svg" height="24"></a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
